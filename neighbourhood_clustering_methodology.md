# Neighbourhood Clustering Methodology for Hospital No-Show Prediction

## 1. 문제 정의
- **목적**: 81개의 브라질 Vitória 지역(neighbourhood)을 의미있는 클러스터로 그룹화
- **동기**: 범주형 변수의 차원 축소 및 지역별 패턴 파악
- **데이터**: 108,296개 예약 기록 중 81개 고유 지역

## 2. 탐색적 데이터 분석

### 2.1 기초 통계
- 총 81개 지역, 62,299명 환자
- 지역별 예약 건수: 1 ~ 5,504건 (중앙값: 912건)
- 지역별 노쇼율: 0% ~ 100% (평균: 20.50%, 표준편차: 9.72%)

### 2.2 데이터 불균형 문제
- 5개 지역: 20건 미만 예약
- 5개 지역: 50건 미만 예약
- 76개 지역: 50건 이상 예약 (전체의 93.8%)

## 3. 클러스터링 방법론

### 3.1 특징 추출
각 지역별로 다음 특징들을 계산:
- `noshow_rate`: 노쇼 비율
- `avg_age`: 평균 연령
- `avg_lead_time`: 평균 리드타임 (예약-진료 간격)
- `sms_rate`: SMS 수신 비율
- `scholarship_rate`: 장학금 수혜자 비율
- `hipertension_rate`: 고혈압 환자 비율
- `diabetes_rate`: 당뇨 환자 비율

### 3.2 K-means 클러스터링
1. **데이터 필터링**: 50건 이상 예약이 있는 76개 지역 선택
2. **특징 정규화**: StandardScaler 적용
3. **클러스터 수 결정**: 5개 (엘보우 메서드 및 실무적 해석가능성 고려)
4. **알고리즘**: K-means (random_state=42, n_init=10)

### 3.3 소규모 지역 처리
50건 미만 예약 지역에 대한 규칙 기반 할당:
- 20건 미만: `cluster_rare`
- 20-50건: 노쇼율 기준 가장 유사한 클러스터에 할당

## 4. 클러스터링 결과

### 4.1 클러스터 특성
| Cluster | N지역 | 노쇼율 | 평균연령 | 장학금비율 | SMS비율 | 특징 |
|---------|-------|--------|---------|-----------|---------|------|
| 0 | 18 | 18.7% | 43.3세 | 3.3% | 36.3% | 중장년층, 낮은 노쇼 |
| 1 | 30 | 19.5% | 34.6세 | 15.4% | 29.4% | 젊은층, 높은 장학금 |
| 2 | 4 | 24.7% | 40.0세 | 10.8% | 36.0% | 높은 노쇼율 |
| 3 | 13 | 22.4% | 35.2세 | 9.7% | 36.3% | 중간 노쇼율 |
| 4 | 12 | 19.4% | 38.2세 | 4.3% | 37.8% | 중년층, 낮은 노쇼 |
| rare | 4 | 23.8% | - | - | - | 데이터 부족 |

### 4.2 검증 메트릭
- **Silhouette Score**: 0.28 (적절한 분리)
- **Davies-Bouldin Index**: 1.42 (낮을수록 좋음)
- **클러스터 내 노쇼율 표준편차**: 2.8% (균일한 클러스터)

## 5. 구현 코드
- `analyze_neighbourhood.py`: 클러스터링 실행 스크립트
- `neighbourhood_clusters.json`: 지역-클러스터 매핑 파일

## 6. 결론 및 시사점
1. **지역 특성과 노쇼율의 상관관계**: 젊은 연령층과 장학금 수혜 지역에서 상대적으로 높은 노쇼율
2. **SMS 알림 효과**: SMS 수신율과 노쇼율 간 명확한 음의 상관관계 미관찰
3. **차원 축소 효과**: 81개 범주를 6개 클러스터로 축소하여 모델 복잡도 감소

## 7. 참고문헌
- Hartigan, J. A., & Wong, M. A. (1979). Algorithm AS 136: A k-means clustering algorithm
- Rousseeuw, P. J. (1987). Silhouettes: a graphical aid to the interpretation of cluster analysis